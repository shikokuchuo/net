---
title: "ichimoku"
description: |
  R package for Ichimoku Kinko Hyo cloud charts
author:
  - name: shikokuchuo
date: 05-16-2021
output:
  distill::distill_article:
    self_contained: false
    toc: true
---

```{r index, echo=FALSE}

photos <- file.path("_images", list.files("_images"))
develop <- function(x) {
  plot(imager::load.image(x), axes = FALSE)
  paste0(openssl::sha256(file(x)))
}
par(mar = c(0, 0, 0, 0))
data.frame(sha256 = develop(photos))

```
<aside> Shikokuchuo </aside>


```{r loaddata, echo = FALSE}
# Sample synthetic data
TKR <- data.frame(
        Date = c("2020-02-02","2020-02-03","2020-02-04",
                 "2020-02-05","2020-02-06","2020-02-07","2020-02-09",
                 "2020-02-10","2020-02-11","2020-02-12","2020-02-13","2020-02-14",
                 "2020-02-16","2020-02-17","2020-02-18","2020-02-19",
                 "2020-02-20","2020-02-21","2020-02-23","2020-02-24","2020-02-25",
                 "2020-02-26","2020-02-27","2020-02-28","2020-03-01",
                 "2020-03-02","2020-03-03","2020-03-04","2020-03-05","2020-03-06",
                 "2020-03-08","2020-03-09","2020-03-10","2020-03-11",
                 "2020-03-12","2020-03-13","2020-03-15","2020-03-16","2020-03-17",
                 "2020-03-18","2020-03-19","2020-03-20","2020-03-22",
                 "2020-03-23","2020-03-24","2020-03-25","2020-03-26","2020-03-27",
                 "2020-03-29","2020-03-30","2020-03-31","2020-04-01",
                 "2020-04-02","2020-04-03","2020-04-05","2020-04-06","2020-04-07",
                 "2020-04-08","2020-04-09","2020-04-10","2020-04-12",
                 "2020-04-13","2020-04-14","2020-04-15","2020-04-16","2020-04-17",
                 "2020-04-19","2020-04-20","2020-04-21","2020-04-22",
                 "2020-04-23","2020-04-24","2020-04-26","2020-04-27","2020-04-28",
                 "2020-04-29","2020-04-30","2020-05-01","2020-05-03",
                 "2020-05-04","2020-05-05","2020-05-06","2020-05-07","2020-05-08",
                 "2020-05-10","2020-05-11","2020-05-12","2020-05-13",
                 "2020-05-14","2020-05-15","2020-05-17","2020-05-18","2020-05-19",
                 "2020-05-20","2020-05-21","2020-05-22","2020-05-24",
                 "2020-05-25","2020-05-26","2020-05-27","2020-05-28","2020-05-29",
                 "2020-05-31","2020-06-01","2020-06-02","2020-06-03",
                 "2020-06-04","2020-06-05","2020-06-07","2020-06-08","2020-06-09",
                 "2020-06-10","2020-06-11","2020-06-12","2020-06-14",
                 "2020-06-15","2020-06-16","2020-06-17","2020-06-18","2020-06-19",
                 "2020-06-21","2020-06-22","2020-06-23","2020-06-24",
                 "2020-06-25","2020-06-26","2020-06-28","2020-06-29","2020-06-30",
                 "2020-07-01","2020-07-02","2020-07-03","2020-07-05",
                 "2020-07-06","2020-07-07","2020-07-08","2020-07-09","2020-07-10",
                 "2020-07-12","2020-07-13","2020-07-14","2020-07-15",
                 "2020-07-16","2020-07-17","2020-07-19","2020-07-20","2020-07-21",
                 "2020-07-22","2020-07-23","2020-07-24","2020-07-26",
                 "2020-07-27","2020-07-28","2020-07-29","2020-07-30","2020-07-31",
                 "2020-08-02","2020-08-03","2020-08-04","2020-08-05",
                 "2020-08-06","2020-08-07","2020-08-09","2020-08-10","2020-08-11",
                 "2020-08-12","2020-08-13","2020-08-14","2020-08-16",
                 "2020-08-17","2020-08-18","2020-08-19","2020-08-20","2020-08-21",
                 "2020-08-23","2020-08-24","2020-08-25","2020-08-26",
                 "2020-08-27","2020-08-28","2020-08-30","2020-08-31","2020-09-01",
                 "2020-09-02","2020-09-03","2020-09-04","2020-09-06",
                 "2020-09-07","2020-09-08","2020-09-09","2020-09-10","2020-09-11",
                 "2020-09-13","2020-09-14","2020-09-15","2020-09-16",
                 "2020-09-17","2020-09-18","2020-09-20","2020-09-21","2020-09-22",
                 "2020-09-23","2020-09-24","2020-09-25","2020-09-27",
                 "2020-09-28","2020-09-29","2020-09-30","2020-10-01","2020-10-02",
                 "2020-10-04","2020-10-05","2020-10-06","2020-10-07",
                 "2020-10-08","2020-10-09","2020-10-11","2020-10-12","2020-10-13",
                 "2020-10-14","2020-10-15","2020-10-16","2020-10-18",
                 "2020-10-19","2020-10-20","2020-10-21","2020-10-22","2020-10-23",
                 "2020-10-25","2020-10-26","2020-10-27","2020-10-28",
                 "2020-10-29","2020-10-30"),
        Open = c(143.4,143.4,142.7,142.4,141.8,141.3,
                 142.7,143,141.9,142.7,142.8,142.8,142.6,142.6,142.8,
                 143.6,143.9,144.7,144.9,144.8,144.6,145,144.7,144.6,144.5,
                 144.4,144.4,144.3,144.6,144,144.4,144.2,144.4,144.5,
                 144.7,145.7,145.3,145.2,145.1,145,145.3,145.4,147.1,
                 147.1,147.8,147.9,147.2,146.9,146.9,146.8,146.3,145.9,
                 145.7,146,145.9,145.7,145.9,146.2,146.3,147.1,146.9,147,
                 145.5,145.1,145,145.8,146.1,146,146.7,147.2,147.6,
                 147.3,146.9,146.8,148.1,147.3,148,149.3,148.2,148.1,147.9,
                 148.1,148.8,149.4,148.8,149,148.1,148.4,147.8,147,
                 146.4,146.3,146.4,146.1,147,148.7,149.3,149.6,149.3,
                 150.1,151.8,151.3,152,152.3,151.3,151.5,151.6,151.7,152,
                 152.1,152.2,151.7,152.7,152.3,152.3,152.4,152.4,153,
                 154.3,154.8,156.4,156.1,156,157.1,156.9,157.4,156.3,156.4,
                 156.8,157.2,158.2,159.4,158.7,158.9,160.9,160.7,161.8,
                 161,161.6,161.7,160.7,159.6,161.1,164.3,164,164.3,
                 163.8,162.7,161.8,163.5,162.8,163,161.9,160.2,160.2,
                 162.9,163.5,163.8,162,162.9,163.8,165.5,165.6,165.6,165.2,
                 166.6,166.3,167,166.4,166.2,167.5,166.3,164.8,163.9,
                 165.3,165.1,164.9,164.6,162.6,162.1,162.5,162.2,160.1,
                 159.4,160,160.4,160.7,160.6,161.3,161.2,160.8,162.6,
                 163.2,163.4,164,162.8,163.3,164.8,162.6,163.3,163.9,163.5,
                 164.8,164.1,163.7,164.5,162.6,163.5,162.7,163.1,163.2,
                 163.2,161.8,161,160.6,166.8,170.3,171.6,171.6,171.6,
                 172.7,173.4,170.6,171.1,168.1,169.9,169.5,170.1,172,
                 172,171.7,171.7,171.9,173.3),
        High = c(143.6,143.5,143,142.7,142.6,143,143.2,
                 143,143.3,143,143.2,142.9,142.8,143.1,143.9,144,
                 144.9,145,145,145,145.5,145.5,145,144.8,144.6,144.6,144.4,
                 144.8,144.8,144.6,144.4,144.6,144.8,144.9,145.9,146.2,
                 145.4,145.4,145.4,145.6,145.4,147.3,147.3,148.2,148.1,
                 148.8,147.3,147.6,147,146.8,146.7,146.1,146.1,146.2,
                 146,146.3,146.5,146.5,147.1,147.8,147.1,147,145.8,
                 145.6,146.1,146.2,146.1,146.8,147.3,147.7,148.2,147.5,147,
                 148.2,148.1,148.1,149.6,149.4,148.3,148.3,148.5,148.9,
                 149.4,149.6,149,149.1,148.7,148.8,147.8,147.5,146.4,
                 146.5,146.6,147.5,149,149.3,149.7,149.7,150.2,151.9,
                 152.3,152.2,152.3,152.4,152.1,151.7,151.9,152.8,152.2,
                 152.5,152.3,152.7,152.9,152.6,152.5,152.4,153.1,154.6,
                 155.1,155.4,156.4,156.1,157.1,157.9,157.5,157.4,156.5,
                 156.9,157.2,158.2,159.5,159.5,159,161.1,161.1,162.7,161.8,
                 161.8,162.1,161.7,161.5,161.2,164.4,164.3,164.7,164.8,
                 164.2,162.7,164.2,164.1,163.1,163,162.8,160.8,163.1,
                 164.2,164,163.8,163.1,164.2,165.6,166.5,165.9,166.6,
                 167.3,167.2,168,167.3,166.4,167.9,167.8,166.4,165.4,
                 165.6,165.7,165.9,165.3,164.7,163,163,162.5,162.8,160.6,
                 160.1,160.9,160.9,160.8,161.4,161.4,161.5,163,164.8,
                 163.5,164.1,164.1,163.8,165,165.9,163.6,164.3,164.6,165.3,
                 165.2,164.5,164.8,164.8,163.6,163.8,163.2,163.3,163.4,
                 163.3,162,161.5,166.9,170,171.7,172.1,172.4,173,
                 173.9,173.5,171.3,171.7,170.3,171.2,170.5,172.5,172.1,
                 172.2,172,172.3,173.8,173.4),
         Low = c(143.4,142.5,142.2,141.8,141.2,141.1,
                 142.7,141.7,141.8,141.9,142.4,141.8,142.6,142.4,142.8,
                 143.3,143.8,144.5,144.5,144.6,144.6,144.1,144.3,144.1,
                 144.3,144.2,143.7,144.1,143.9,143.7,144.2,144,144.3,144,
                 144.6,145,145.2,144.9,144.7,144.9,144.4,145.3,147,
                 146.8,147.4,146.9,146.2,146.8,146.8,146,145.8,145.3,
                 145.6,145.4,145.6,145.5,145.8,145.8,146.2,146.7,146.9,
                 145.1,144.9,144.9,144.7,145.5,146,145.5,146.5,146.7,147.1,
                 146.8,146.7,146.7,146.9,147.1,148,148,148,147.6,147,
                 147.8,148.8,148.7,148.8,148,147.9,147.4,146.7,146,
                 146.3,146,145.7,146,146.9,148.3,149.2,148.9,149,150,151.1,
                 150.8,151.9,151.1,151.3,150.5,151.3,151.6,151.9,151.6,
                 151.6,151.7,152,151.7,152.3,151.7,152.3,152.9,154.2,
                 154.3,155.8,155.4,155.8,156.3,156.2,155.9,156.2,156.3,
                 156.4,157.2,158.1,158.2,158.5,158.7,160.6,160.5,160.2,
                 160.5,161.6,160.5,159.4,159.6,160.9,163,163.9,162.8,
                 161.7,160.5,160.9,162.5,162.8,161.8,159.8,159.3,159.9,
                 162.5,163.5,161.9,161.9,162.9,163.4,164.9,165.5,164.9,
                 164.9,165.9,166,165.1,165.8,166,165.3,164.7,163.6,162.8,
                 165,164.8,163.9,162.4,161.3,161.5,161.9,157.9,157.8,
                 158.1,159.5,159.1,160.3,160.2,160.6,160.5,160.6,162.5,
                 163.1,162.8,162,162.6,163,163.8,162.3,162.4,163.2,163.2,
                 163.4,163,163.7,161.9,162.5,162,162.2,162.6,163.2,
                 161.7,160.9,160.5,160.4,166,170.3,170.6,170.6,171.4,
                 172.3,170.5,170.6,166.4,167.7,168.1,168.7,169.9,171.9,
                 170.9,170,171.1,171.4,171.1),
       Close = c(143.4,142.7,142.4,141.8,141.3,142.7,
                 143,141.9,142.7,142.8,142.8,142.8,142.6,142.8,143.6,
                 143.9,144.7,144.9,144.8,144.6,145,144.7,144.6,144.3,144.4,
                 144.4,144.3,144.6,144,144.3,144.2,144.4,144.5,144.7,
                 145.7,145.2,145.2,145.1,145,145.3,145.4,147.1,147.1,
                 147.8,147.9,147.2,146.9,146.8,146.8,146.3,145.9,145.7,
                 146,146,145.7,145.9,146.2,146.3,147.1,146.9,147,145.5,
                 145.1,145,145.8,146.1,146,146.7,147.2,147.6,147.3,146.8,
                 146.8,148.1,147.3,148,149.3,148.2,148.1,147.9,148.1,
                 148.8,149.4,148.8,149,148.1,148.4,147.8,147,146.3,
                 146.3,146.4,146.1,147,148.7,149.1,149.6,149.3,150.1,151.8,
                 151.3,152,152.3,151.3,151.5,151.6,151.7,152,152.1,
                 152.2,151.7,152.7,152.3,152.3,152.4,152.4,153,154.3,154.8,
                 155,156.1,156,157.1,156.9,157.4,156.2,156.4,156.8,
                 157.2,158.2,159.4,158.8,158.9,160.6,160.7,161.8,161,
                 161.6,161.7,160.7,159.6,161.1,164.3,163.8,164.3,163.8,
                 162.7,161.8,163.5,162.9,163,161.9,160.2,160.2,162.9,163.6,
                 163.8,162,162.9,163.8,165.5,165.7,165.6,165.2,166.6,
                 166.3,167,166.5,166.2,167.5,166.3,164.8,163.9,165,165.1,
                 164.9,164.6,162.6,162.1,161.6,162.2,160.1,159.4,160,
                 160.4,160.7,160.6,161.3,161.2,160.8,162.6,163.2,163.4,
                 164,162.8,163.3,164.8,164,163.3,163.9,163.5,164.8,
                 164.1,163.9,164.5,162.6,163.5,162.7,163.1,163.3,163.2,
                 161.8,161,160.6,166.8,169.6,171.6,171.6,171.6,172.7,173.4,
                 170.9,171.1,168.1,169.9,169.5,170.1,171.5,172,171.7,
                 171.7,171.9,173.3,171.7)
)
```

An implementation of the Ichimoku Kinko Hyo charting technique, also commonly known as 'cloud charts' in R.

### Example

Have fun with the interactive chart below!

```{r plot, layout="l-body-outset"}
library(ichimoku)
cloud <- ichimoku(TKR)
iplot(cloud, from = "2020-05-01", to = "2020-12-03")
```

### Installation

You can install the released version of ichimoku from [Github](https://github.com/shikokuchuo/ichimoku/) with:

``` r
devtools::install_github("shikokuchuo/ichimoku")
```

### Package site

Hosted ourselves at: https://shikokuchuo.net/ichimoku/

### Ichimoku Kinko Hyo

The system consists of the following chart lines added to a candlestick chart:

**Tenkan-sen**: [conversion line] the mid-point of the highest high and lowest low for the past 9 periods.

**Kijun-sen**: [base line] the mid-point of the highest high and lowest low for the past 26 periods.

**Senkou span A**: [leading span A] the mid-point of Tenkan-sen and Kijun-sen plotted ahead 26 periods.

**Senkou span B**: [leading span B] the mid-point of the highest high and lowest low for the past 52 periods, plotted ahead 26 periods.

**Chikou span**: [lagging span] the current closing price plotted 26 periods behind.

The **kumo** [cloud] is the area between Senkou span A and Senkou span B (usually shaded on a chart).

### Interpretation

Ichimoku Kinko Hyo translates roughly to ‘one-glance equilibrium chart’. It is designed to allow the price action and market structure of financial securities to be determined ‘at-a-glance’ in a highly visual fashion.

For example in a strongly upwards-trending market, the candlesticks will be above the Tenkan-sen, which will be above the Kijun-sen, which will be above the cloud, and the chikou span may not have anything above it.

The lines and the cloud represent dynamic support and resistance zones relative to the price candles. Generally the thicker the cloud, the tougher the support/resistance. In our previous example, if the price now reverts downwards, it can expect support first at the Kijun-sen, then the Tenkan-sen and finally the cloud itself.

More subtle interpretations involve the chikou span in particular and its action in relation to the cloud lines as well as the candles.

### Context

Ichimoku analysis is the latest evolution in refining candlestick charting techniques, which also originated from Japan in the 18th century. Actually developed during the mid-20th century, it gained popularity especially from the late 1990s onwards, and is now used on trading floors worldwide.

The time periods have traditionally been calculated as 9, 26 and 52 based on manual data analysis performed in Japan in a pre-computer age where there was a 6-day working week resulting in 26 average trading days in a month. Although this bears little relevance to the current day, the use of these time periods has persisted as an ‘industry norm’ or ‘accepted practice’.

To use other periods would be meaningless in a sense as everyone uses these parameters and ‘market psychology’ can and often does create its own realities, independent of any fundamentals. However, there is no reason for the technique not to evolve, and to reflect changing trading realities, perhaps psychologically other parameters will become more relevant.

Also the use originated with daily candlesticks, and the most valid interpretation remains for daily data. However, it is equally used today for both shorter intra-day, e.g. 4-hour or hourly, and longer, e.g. weekly or monthly, charts.

